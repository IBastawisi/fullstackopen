(this["webpackJsonpbloglist-frontend"]=this["webpackJsonpbloglist-frontend"]||[]).push([[0],{153:function(e,t,n){},154:function(e,t,n){},155:function(e,t,n){"use strict";n.r(t);var r=n(2),a=n(0),c=n.n(a),s=n(31),u=n.n(s),i=n(9),o=n(12),l=n(37),b={user:null,users:[],blogs:[],ui:{loading:!0,announcement:null}},j=Object(l.b)({name:"user",initialState:b.user,reducers:{load:function(e,t){return t.payload}}}),d=Object(l.b)({name:"users",initialState:b.users,reducers:{load:function(e,t){return t.payload}}}),h=Object(l.b)({name:"blogs",initialState:b.blogs,reducers:{load:function(e,t){return t.payload},add:function(e,t){e.push(t.payload)},update:function(e,t){return e.map((function(e){return e.id===t.payload.id?t.payload:e}))},delete:function(e,t){return e.filter((function(e){return e.id!==t.payload}))}}}),O=Object(l.b)({name:"ui",initialState:b.ui,reducers:{setLoading:function(e,t){e.loading=t.payload},announce:function(e,t){e.announcement=t.payload},clearAnnouncement:function(e){e.announcement=null}}}),p={user:j.reducer,users:d.reducer,blogs:h.reducer,ui:O.reducer},f={user:j.actions,users:d.actions,blogs:h.actions,ui:O.actions},x=Object(l.a)({reducer:p}),m=n(23),g=n(20),v=n(6),w=n.n(v),y=n(11),k=n(10),S=n(24),C=n.n(S),A="/api/blogs",B=null,L={getAll:function(){return C.a.get(A).then((function(e){return e.data}))},create:function(){var e=Object(y.a)(w.a.mark((function e(t){var n,r;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:B}},e.next=3,C.a.post(A,t,n);case 3:return r=e.sent,e.abrupt("return",r.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),update:function(){var e=Object(y.a)(w.a.mark((function e(t,n){var r,a;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={headers:{Authorization:B}},e.next=3,C.a.put("".concat(A,"/").concat(t),n,r);case 3:return a=e.sent,e.abrupt("return",a.data);case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),remove:function(){var e=Object(y.a)(w.a.mark((function e(t){var n,r;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:B}},e.next=3,C.a.delete("".concat(A,"/").concat(t),n);case 3:return r=e.sent,e.abrupt("return",r.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),setToken:function(e){B="bearer ".concat(e)}},T=n(30),U=(n(126),n(27)),N=(n(128),n(69)),E=n(67),D=(n(66),n(4)),I=function(){var e=Object(a.useState)(""),t=Object(g.a)(e,2),n=t[0],c=t[1],s=Object(i.b)(),u=Object(k.i)().id,o=Object(k.g)(),l=Object(i.c)((function(e){return e.user})),b=Object(i.c)((function(e){return e.blogs.find((function(e){return e.id===u}))})),j=function(){var e=Object(y.a)(w.a.mark((function e(){var t;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,L.update(b.id,{likes:b.likes+1});case 3:t=e.sent,s(f.blogs.update(t)),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),s(f.ui.announce(e.t0.response.data.error));case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}(),d=function(){var e=Object(y.a)(w.a.mark((function e(){var t;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,L.update(b.id,{comments:b.comments.concat(n)});case 3:t=e.sent,s(f.blogs.update(t)),s(f.ui.announce("Comment has been saved")),c(""),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),s(f.ui.announce(e.t0.response.data.error));case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}(),h=function(){var e=Object(y.a)(w.a.mark((function e(){return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,L.remove(b.id);case 3:s(f.blogs.delete(b.id)),s(f.ui.announce("Blog ".concat(b.title," has been deleted"))),o.push("/"),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),s(f.ui.announce(e.t0.response.data.error));case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}(),O=function(){var e=Object(y.a)(w.a.mark((function e(){return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:window.confirm("Are you sure to permenantly delete ".concat(b.title,"?"))&&h();case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return b?Object(r.jsxs)(r.Fragment,{children:[Object(r.jsxs)(U.a,{style:{width:"100%"},children:[Object(r.jsx)(U.e,{children:Object(r.jsxs)("div",{style:{padding:"0 1rem 1rem 1rem"},children:[Object(r.jsx)(T.a,{use:"headline6",tag:"h2",children:b.title}),Object(r.jsxs)(T.a,{use:"subtitle2",tag:"h3",theme:"textSecondaryOnBackground",style:{marginTop:"-1rem"},children:["by ",b.author]}),Object(r.jsxs)(T.a,{use:"subtitle2",tag:"h3",theme:"textSecondaryOnBackground",children:["Likes: ",b.likes]}),Object(r.jsxs)(T.a,{use:"body1",tag:"div",theme:"textSecondaryOnBackground",children:["for more info visit: ",Object(r.jsx)("a",{href:b.url,target:"_blank",rel:"noreferrer",children:b.url})]})]})}),Object(r.jsx)(U.d,{children:Object(r.jsxs)(U.c,{children:[Object(r.jsx)(U.b,{icon:"thumb_up",onClick:j}),l&&b.user.username===l.username&&Object(r.jsx)(U.b,{onClick:O,icon:"delete"})]})})]}),Object(r.jsx)(T.a,{use:"headline6",tag:"h2",children:"Comments"}),Object(r.jsxs)("div",{style:{display:"flex"},children:[Object(r.jsx)(D.j,{textarea:!0,fullwidth:!0,rows:1,value:n,onChange:function(e){return c(e.target.value)},label:"Add comment"}),Object(r.jsx)(D.a,{onClick:d,label:"Save",style:{margin:"0 1rem",alignSelf:"flex-end"}})]}),Object(r.jsx)(N.a,{children:b.comments&&b.comments.map((function(e,t){return Object(r.jsx)(E.a,{style:{whiteSpace:"pre-wrap"},children:e},"".concat(e.id,"-").concat(t))}))})]}):null},J=function(){var e=Object(k.i)().username,t=Object(i.c)((function(t){return t.users.find((function(t){return t.username===e}))}));return t?Object(r.jsxs)("div",{children:[Object(r.jsxs)("h2",{children:["User ",e]}),Object(r.jsxs)("h3",{children:["Blogs added by ",t.name]}),Object(r.jsx)(D.g,{children:t.blogs.map((function(e){return Object(r.jsx)(D.h,{tag:o.b,to:"/blogs/".concat(e.id),children:e.title},e.id)}))})]}):Object(r.jsx)(D.b,{})},P="/api/users",z={getAll:function(){return C.a.get(P).then((function(e){return e.data}))},register:function(){var e=Object(y.a)(w.a.mark((function e(t){var n;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.a.post(P,t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},H=(n(134),function(){var e=Object(i.c)((function(e){return e.ui.announcement})),t=Object(a.useState)(null),n=Object(g.a)(t,2),c=n[0],s=n[1],u=Object(i.b)();return Object(a.useEffect)((function(){return e&&(c&&clearTimeout(c),s(setTimeout((function(){return u(f.ui.clearAnnouncement())}),3e3))),function(){clearTimeout(c),s(null)}}),[e]),e?Object(r.jsx)(D.i,{open:!0,message:e}):null}),R=n(29),F=n(17),W=(n(47),function(e){return C.a.post("/api/login",e).then((function(e){return e.data}))}),_=function(){var e=Object(a.useState)({username:"",password:""}),t=Object(g.a)(e,2),n=t[0],c=t[1],s=Object(i.b)(),u=Object(k.g)(),l=function(e){var t=e.target,r=t.name,a=t.value;c(Object(m.a)(Object(m.a)({},n),{},Object(R.a)({},r,a)))},b=function(){var e=Object(y.a)(w.a.mark((function e(t){var r;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,e.next=4,W(n);case 4:r=e.sent,window.localStorage.setItem("loggedinUser",JSON.stringify(r)),L.setToken(r.token),s(f.user.load(r)),u.push("/"),s(f.ui.announce("Welcome back, ".concat(r.name))),c({username:"",password:""}),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(1),s(f.ui.announce("wrong credentials"));case 16:case"end":return e.stop()}}),e,null,[[1,13]])})));return function(t){return e.apply(this,arguments)}}();return Object(r.jsxs)("div",{className:"form-container",children:[Object(r.jsx)("h2",{children:"Login"}),Object(r.jsxs)("form",{onSubmit:b,children:[Object(r.jsx)(F.a,{name:"username",value:n.username,onChange:l,label:"Username"}),Object(r.jsx)(F.a,{name:"password",type:"password",value:n.password,onChange:l,label:"Password"}),Object(r.jsx)(D.a,{type:"submit",label:"Login",style:{margin:16}}),Object(r.jsxs)("div",{children:[Object(r.jsx)(D.k,{use:"subtitle2",tag:"span",theme:"textSecondaryOnBackground",children:"Don't have account?"}),Object(r.jsx)(D.a,{tag:o.b,to:"/register",label:"Register",style:{margin:16}})]})]})]})},q=function(){var e=Object(a.useState)({username:"",name:"",password:""}),t=Object(g.a)(e,2),n=t[0],c=t[1],s=Object(i.b)(),u=Object(k.g)(),o=function(e){var t=e.target,r=t.name,a=t.value;c(Object(m.a)(Object(m.a)({},n),{},Object(R.a)({},r,a)))},l=function(){var e=Object(y.a)(w.a.mark((function e(t){return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,e.next=4,z.register(n);case 4:s(f.ui.announce("Account created! please login to continue")),c({username:"",name:"",password:""}),u.push("/login"),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),s(f.ui.announce(e.t0.response.data.error));case 12:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t){return e.apply(this,arguments)}}();return Object(r.jsxs)("div",{className:"form-container",children:[Object(r.jsx)("h2",{children:"Register"}),Object(r.jsxs)("form",{onSubmit:l,children:[Object(r.jsx)(F.a,{name:"username",value:n.username,onChange:o,label:"Username"}),Object(r.jsx)(F.a,{name:"name",value:n.name,onChange:o,label:"Name"}),Object(r.jsx)(F.a,{name:"password",type:"password",value:n.password,onChange:o,label:"Password"}),Object(r.jsx)(D.a,{type:"submit",label:"Register",style:{margin:16}})]})]})},G=function(){var e=Object(a.useState)({title:"",author:"",url:""}),t=Object(g.a)(e,2),n=t[0],c=t[1],s=Object(i.b)(),u=Object(k.g)(),o=function(e){var t=e.target,r=t.name,a=t.value;c(Object(m.a)(Object(m.a)({},n),{},Object(R.a)({},r,a)))},l=function(){var e=Object(y.a)(w.a.mark((function e(t){return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),b(n),c({title:"",author:"",url:""});case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),b=function(){var e=Object(y.a)(w.a.mark((function e(t){var n;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,L.create(t);case 3:n=e.sent,s(f.ui.announce("Blog ".concat(n.title," has been added"))),s(f.blogs.add(n)),u.push("/"),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),s(f.ui.announce(e.t0.response.data.error));case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t){return e.apply(this,arguments)}}();return Object(r.jsxs)("div",{className:"form-container",children:[Object(r.jsx)("h2",{children:"Create new Blog"}),Object(r.jsxs)("form",{onSubmit:l,children:[Object(r.jsx)(F.a,{name:"title",value:n.title,onChange:o,label:"Title"}),Object(r.jsx)(F.a,{name:"author",value:n.author,onChange:o,label:"Author"}),Object(r.jsx)(F.a,{name:"url",value:n.url,onChange:o,label:"Url"}),Object(r.jsx)(D.a,{type:"submit",label:"Add",style:{margin:16}})]})]})},K=n(25);n(63),n(68),n(144),n(146),n(61),n(148),n(150),n(153);function M(){return Object(r.jsxs)("div",{children:[Object(r.jsx)("h2",{children:"About"}),Object(r.jsx)("p",{children:"Blog List App"})]})}var Q=function(e){var t=e.blogs;return Object(r.jsxs)("div",{children:[Object(r.jsx)("h2",{children:"All Blogs"}),Object(r.jsx)(D.g,{children:t.map((function(e){return Object(r.jsx)(D.h,{tag:o.b,to:"/blogs/".concat(e.id),children:e.title},e.id)}))})]})},V=function(e){var t=e.users;return Object(r.jsxs)("div",{children:[Object(r.jsx)("h2",{children:"Users"}),Object(r.jsx)(D.g,{children:t.map((function(e){return Object(r.jsxs)(D.h,{tag:o.b,to:"/users/".concat(e.username),children:[e.name," has ",e.blogs.length," blogs"]},e.username)}))})]})},X=function(){var e=Object(i.c)((function(e){return e.user})),t=Object(i.c)((function(e){return e.users})),n=Object(i.c)((function(e){return e.ui.loading})),s=Object(i.c)((function(e){return e.ui.announcement})),u=Object(i.c)((function(e){return e.blogs.slice().sort((function(e,t){return t.likes-e.likes}))})),l=Object(i.b)(),b=(Object(k.g)(),Object(k.h)());Object(a.useEffect)(Object(y.a)(w.a.mark((function e(){var t,n;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,L.getAll();case 2:return t=e.sent,l(f.blogs.load(t)),e.next=6,z.getAll();case 6:n=e.sent,l(f.users.load(n)),l(f.ui.setLoading(!1));case 9:case"end":return e.stop()}}),e)}))),[]),Object(a.useEffect)((function(){var e=window.localStorage.getItem("loggedinUser");if(e){var t=JSON.parse(e);l(f.user.load(t)),L.setToken(t.token)}}),[]);var j=c.a.useState(!0),d=Object(g.a)(j,2),h=d[0],O=d[1];return Object(r.jsxs)("div",{children:[Object(r.jsx)(K.a,{fixed:!0,children:Object(r.jsxs)(K.d,{children:[Object(r.jsxs)(K.e,{children:[Object(r.jsx)(K.c,{icon:"menu",onClick:function(){return O(!h)}}),Object(r.jsx)(K.f,{children:"Blogs"})]}),Object(r.jsxs)(K.e,{alignEnd:!0,children:[!e&&Object(r.jsx)(D.a,{label:"Login",theme:"onPrimary",outlined:!0,icon:"login",tag:o.b,to:"/login"}),e&&Object(r.jsxs)("div",{children:[Object(r.jsxs)("span",{style:{padding:"0 1rem"},children:["Welcome, ",e.name]}),Object(r.jsx)(D.a,{label:"Logout",theme:"onPrimary",outlined:!0,onClick:function(){window.localStorage.removeItem("loggedinUser"),L.setToken(""),l(f.user.load(null)),l(f.ui.announce("Logged out!"))}})]})]})]})}),Object(r.jsx)(K.b,{}),Object(r.jsxs)("div",{style:{overflow:"hidden",position:"relative",minHeight:"calc(100vh - 64px)"},children:[Object(r.jsx)(D.c,{dismissible:!0,open:h,children:Object(r.jsx)(D.e,{children:Object(r.jsxs)(D.g,{children:[Object(r.jsx)(D.h,{activated:"/"===b.pathname,tag:o.b,to:"/",children:"Home"}),Object(r.jsx)(D.h,{activated:"/users"===b.pathname,tag:o.b,to:"/users",children:"Users"}),Object(r.jsx)(D.h,{activated:"/about"===b.pathname,tag:o.b,to:"/about",children:"About"})]})})}),Object(r.jsx)(D.d,{style:{minHeight:"15rem",padding:"1rem"},children:Object(r.jsxs)(k.d,{children:[Object(r.jsx)(k.b,{path:"/login",children:Object(r.jsx)(_,{})}),Object(r.jsx)(k.b,{path:"/register",children:Object(r.jsx)(q,{})}),Object(r.jsx)(k.b,{path:"/create",children:e?Object(r.jsx)(G,{}):n?Object(r.jsx)(D.b,{}):Object(r.jsx)(k.a,{to:"/login"})}),Object(r.jsx)(k.b,{path:"/about",children:Object(r.jsx)(M,{})}),Object(r.jsx)(k.b,{path:"/users/:username",children:t?Object(r.jsx)(J,{}):Object(r.jsx)(D.b,{})}),Object(r.jsx)(k.b,{path:"/blogs/:id",children:n?Object(r.jsx)(D.b,{}):Object(r.jsx)(I,{})}),Object(r.jsx)(k.b,{path:"/users",children:t?Object(r.jsx)(V,{users:t}):Object(r.jsx)(D.b,{})}),Object(r.jsx)(k.b,{path:"/",children:n?Object(r.jsx)(D.b,{}):Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)(Q,{blogs:u}),e&&Object(r.jsx)(D.f,{label:"Create",icon:"add",tag:o.b,to:"/create",style:{position:"fixed",bottom:32,right:32}})]})})]})})]}),Object(r.jsx)("nav",{children:Object(r.jsx)("div",{style:{display:"flex",justifyContent:"space-between"}})}),Object(r.jsx)(H,Object(m.a)({},{announcement:s}))]})};n(154);u.a.render(Object(r.jsx)(i.a,{store:x,children:Object(r.jsx)(o.a,{children:Object(r.jsx)(X,{})})}),document.getElementById("root"))}},[[155,1,2]]]);
//# sourceMappingURL=main.b8710cf3.chunk.js.map